language: php

php:
  - 7.0

git:
  depth: 1

cache:
  directories:
    - vendor
    - $HOME/.composer/cache

sudo: required
dist: trusty

install:
  - chmod a+x $TRAVIS_BUILD_DIR/testing.sh
  - chmod a+rx -R $TRAVIS_BUILD_DIR
  - $TRAVIS_BUILD_DIR/testing.sh

before_script:
  - phpenv config-add $TRAVIS_BUILD_DIR/util/travis_php.ini

script:
  - cd $TRAVIS_BUILD_DIR && ./vendor/bin/codecept run --debug --no-interaction --fail-fast

after_failure:
  - cat $TRAVIS_BUILD_DIR/tests/_output/*